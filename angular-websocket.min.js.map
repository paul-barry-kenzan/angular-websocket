{"version":3,"sources":["src/angular-websocket.js"],"names":["$WebSocketProvider","$rootScope","$q","$timeout","$websocketBackend","$WebSocket","url","protocols","options","isObject","isArray","undefined","this","ssl","test","scope","rootScopeFailover","useApplyAsync","initialTimeout","maxTimeout","reconnectIfNotNormalClose","_reconnectAttempts","sendQueue","onOpenCallbacks","onMessageCallbacks","onErrorCallbacks","onCloseCallbacks","objectFreeze","_readyStateConstants","_connect","_setInternalState","prototype","CONNECTING","OPEN","CLOSING","CLOSED","RECONNECT_ABORTED","_normalCloseCode","_notAuthenticatedCloseCode","_reconnectableStatusCodes","safeDigest","autoApply","$$phase","$digest","bindToScope","self","$on","force","socket","readyState","create","onmessage","angular","bind","_onMessageHandler","onopen","_onOpenHandler","onerror","_onErrorHandler","onclose","_onCloseHandler","fireQueue","length","data","shift","send","isString","message","JSON","stringify","deferred","resolve","notifyOpenCallbacks","event","i","call","notifyCloseCallbacks","notifyErrorCallbacks","onOpen","cb","push","onClose","onError","onMessage","callback","isFunction","Error","isDefined","filter","RegExp","fn","pattern","code","indexOf","reconnect","applyAsyncOrDigest","args","arraySlice","arguments","$applyAsync","apply","currentCallback","exec","close","bufferedAmount","cancelableify","promise","cancel","then","newPromise","reason","splice","reject","defer","isMocked","isConnected","mockSend","backoffDelay","_getBackoffDelay","attempt","R","Math","random","T","F","N","M","floor","min","pow","state","objectDefineProperty","_internalConnectionState","forEach","pending","get","set","$WebSocketBackendProvider","$window","$log","Socket","ws","match","exports","require","Client","client","e","WebSocket","MozWebSocket","createWebSocketBackend","warn","noop","Object","freeze","defineProperty","Array","slice","elt","len","from","Number","ceil","module","factory","service","define"],"mappings":"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"}